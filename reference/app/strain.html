
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Correlation-based peak finding and strain mapping reference &#8212; LiberTEM 0.4.0.dev0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Phase-change materials reference" href="phasechange.html" />
    <link rel="prev" title="Amorphous materials reference" href="amorphous.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="correlation-based-peak-finding-and-strain-mapping-reference">
<h1>Correlation-based peak finding and strain mapping reference<a class="headerlink" href="#correlation-based-peak-finding-and-strain-mapping-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="blobfinder">
<span id="blobfinder-api"></span><h2>Blobfinder<a class="headerlink" href="#blobfinder" title="Permalink to this headline">¶</a></h2>
<p>This module contains classes and helper functions that allow to apply correlation and refinement on a dataset
using the <a class="reference internal" href="../../udf.html#user-defined-functions"><span class="std std-ref">User-defined functions</span></a> interface.</p>
<div class="section" id="match-patterns">
<h3>Match patterns<a class="headerlink" href="#match-patterns" title="Permalink to this headline">¶</a></h3>
<p>Correlation pattern classes with support for Fourier-based fast correlation.</p>
<span class="target" id="module-libertem.udf.blobfinder.patterns"></span><dl class="class">
<dt id="libertem.udf.blobfinder.patterns.BackgroundSubtraction">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">BackgroundSubtraction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em>, <em class="sig-param">radius_outer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#BackgroundSubtraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.BackgroundSubtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Solid circular disk surrounded with a balancing negative area</p>
<p>This pattern rejects background and avoids false positives at positions between peaks</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.BackgroundSubtraction.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em>, <em class="sig-param">radius_outer=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#BackgroundSubtraction.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.BackgroundSubtraction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius of the circular pattern in px</p></li>
<li><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Range from the center point in px to include in the correlation.
<code class="code docutils literal notranslate"><span class="pre">max(2*radius,</span> <span class="pre">radius_outer)</span></code> by default.
Defining the size of the square correlation pattern.</p></li>
<li><p><strong>radius_outer</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Radius of the negative region in px. 1.5x radius by default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.patterns.Circular">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">Circular</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#Circular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.Circular" title="Permalink to this definition">¶</a></dt>
<dd><p>Circular pattern with radius <code class="code docutils literal notranslate"><span class="pre">radius</span></code>.</p>
<p>This pattern is useful for constructing feature vectors using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">feature_vector()</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.3.0.</span></p>
</div>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.Circular.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#Circular.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.Circular.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius of the circular pattern in px</p></li>
<li><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Range from the center point in px to include in the correlation, 2x radius by default.
Defining the size of the square correlation pattern.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.patterns.MatchPattern">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">MatchPattern</code><span class="sig-paren">(</span><em class="sig-param">search</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#MatchPattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for correlation patterns.</p>
<p>This class provides an API to provide a template for fast correlation-based peak finding.</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.MatchPattern.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">search</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#MatchPattern.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.MatchPattern.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Range from the center point in px to include in the correlation, defining the size
of the square correlation pattern.
Will be ceiled to the next int for performing the correlation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.patterns.RadialGradient">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">RadialGradient</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#RadialGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.RadialGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial gradient from zero in the center to one at <code class="code docutils literal notranslate"><span class="pre">radius</span></code>.</p>
<p>This pattern rejects the influence of internal intensity variations of the CBED disk.</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.RadialGradient.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#RadialGradient.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.RadialGradient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius of the circular pattern in px</p></li>
<li><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Range from the center point in px to include in the correlation, 2x radius by default.
Defining the size of the square correlation pattern.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.patterns.RadialGradientBackgroundSubtraction">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">RadialGradientBackgroundSubtraction</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em>, <em class="sig-param">radius_outer=None</em>, <em class="sig-param">delta=1</em>, <em class="sig-param">radial_map=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#RadialGradientBackgroundSubtraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.RadialGradientBackgroundSubtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Combination of radial gradient with background subtraction</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.RadialGradientBackgroundSubtraction.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">radius</em>, <em class="sig-param">search=None</em>, <em class="sig-param">radius_outer=None</em>, <em class="sig-param">delta=1</em>, <em class="sig-param">radial_map=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#RadialGradientBackgroundSubtraction.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.RadialGradientBackgroundSubtraction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="../masks.html#libertem.masks.radial_gradient_background_subtraction" title="libertem.masks.radial_gradient_background_subtraction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">radial_gradient_background_subtraction()</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius of the circular pattern in px</p></li>
<li><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Range from the center point in px to include in the correlation.
<code class="code docutils literal notranslate"><span class="pre">max(2*radius,</span> <span class="pre">radius_outer)</span></code> by default
Defining the size of the square correlation pattern.</p></li>
<li><p><strong>radius_outer</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Radius of the negative region in px. 1.5x radius by default.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Width of the transition region between positive and negative in px</p></li>
<li><p><strong>radial_map</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Radius value of each pixel in px. This can be used to distort the shape as needed
or work in physical coordinates instead of pixels.
A suitable map can be generated with <a class="reference internal" href="../masks.html#libertem.masks.polar_map" title="libertem.masks.polar_map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">libertem.masks.polar_map()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">=</span> <span class="n">libertem</span><span class="o">.</span><span class="n">masks</span><span class="o">.</span><span class="n">polar_map</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">centerX</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">centerY</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">imageSizeX</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">imageSizeY</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">stretchY</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">template</span> <span class="o">=</span> <span class="n">RadialGradientBackgroundSubtraction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">radius</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">radial_map</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This shows an elliptical template that is stretched</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># along the 45 ° bottom-left top-right diagonal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">get_mask</span><span class="p">(</span><span class="n">sig_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)))</span>
<span class="go">&lt;matplotlib.image.AxesImage object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.patterns.UserTemplate">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.patterns.</code><code class="sig-name descname">UserTemplate</code><span class="sig-paren">(</span><em class="sig-param">template</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#UserTemplate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.UserTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>User-defined template</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.patterns.UserTemplate.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">template</em>, <em class="sig-param">search=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/patterns.html#UserTemplate.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.patterns.UserTemplate.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Correlation template as 2D numpy.ndarray</p></li>
<li><p><strong>search</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Range from the center point in px to include in the correlation.
Half diagonal of the template by default.
Defining the size of the square correlation pattern.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="correlation">
<h3>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h3>
<p>UDFs and utility functions to find peaks and refine their positions by using
correlation.</p>
<span class="target" id="module-libertem.udf.blobfinder.correlation"></span><dl class="class">
<dt id="libertem.udf.blobfinder.correlation.CorrelationUDF">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">CorrelationUDF</code><span class="sig-paren">(</span><em class="sig-param">peaks</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#CorrelationUDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.CorrelationUDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.base.UDF</span></code></p>
<p>Abstract base class for peak correlation implementations</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.CorrelationUDF.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">peaks</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#CorrelationUDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Numpy array of (y, x) coordinates with peak positions in px to correlate</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers">
<code class="sig-name descname">get_result_buffers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#CorrelationUDF.get_result_buffers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="Permalink to this definition">¶</a></dt>
<dd><p>The common buffers for all correlation methods.</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">centers</span></code>:</dt><dd><p>(y, x) integer positions.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">refineds</span></code>:</dt><dd><p>(y, x) positions with subpixel refinement.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">peak_values</span></code>:</dt><dd><p>Peak height in the log scaled frame.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">peak_elevations</span></code>:</dt><dd><p>Peak quality (result of <a class="reference internal" href="#libertem.udf.blobfinder.correlation.peak_elevation" title="libertem.udf.blobfinder.correlation.peak_elevation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">peak_elevation()</span></code></a>).</p>
</dd>
</dl>
<p>See source code for details of the buffer declaration.</p>
</dd></dl>

<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.CorrelationUDF.output_buffers">
<code class="sig-name descname">output_buffers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#CorrelationUDF.output_buffers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.output_buffers" title="Permalink to this definition">¶</a></dt>
<dd><p>This function allows abstraction of the result buffers from
the default implementation in <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_result_buffers()</span></code></a>.</p>
<p>Override this function if you wish to redirect the results to different
buffers, for example ragged arrays or binned processing.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.correlation.FastCorrelationUDF">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">FastCorrelationUDF</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#FastCorrelationUDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.FastCorrelationUDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF" title="libertem.udf.blobfinder.correlation.CorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.correlation.CorrelationUDF</span></code></a></p>
<p>Fourier-based fast correlation-based refinement of peak positions within a search frame
for each peak.</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.FastCorrelationUDF.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#FastCorrelationUDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.FastCorrelationUDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Numpy array of (y, x) coordinates with peak positions in px to correlate</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.correlation.FullFrameCorrelationUDF">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">FullFrameCorrelationUDF</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#FullFrameCorrelationUDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.FullFrameCorrelationUDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF" title="libertem.udf.blobfinder.correlation.CorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.correlation.CorrelationUDF</span></code></a></p>
<p>Fourier-based correlation-based refinement of peak positions within a search
frame for each peak using a single correlation step. This can be faster for
correlating a large number of peaks in small frames in comparison to
<a class="reference internal" href="#libertem.udf.blobfinder.correlation.FastCorrelationUDF" title="libertem.udf.blobfinder.correlation.FastCorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastCorrelationUDF</span></code></a>. However, it is more sensitive to interference
from strong peaks next to the peak of interest.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.3.0.</span></p>
</div>
<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.FullFrameCorrelationUDF.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#FullFrameCorrelationUDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.FullFrameCorrelationUDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Numpy array of (y, x) coordinates with peak positions in px to correlate</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.correlation.SparseCorrelationUDF">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">SparseCorrelationUDF</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#SparseCorrelationUDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.SparseCorrelationUDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF" title="libertem.udf.blobfinder.correlation.CorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.correlation.CorrelationUDF</span></code></a></p>
<p>Direct correlation using sparse matrices</p>
<p>This method allows to adjust the number of correlation steps independent of the template size.</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.SparseCorrelationUDF.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#SparseCorrelationUDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.SparseCorrelationUDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Numpy array of (y, x) coordinates with peak positions in px to correlate</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code></p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The template is correlated with 2 * steps + 1 symmetrically around the peak position
in x and y direction. This defines the maximum shift that can be
detected. The number of calculations grows with the square of this value, that means
keeping this as small as the data allows speeds up the calculation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.SparseCorrelationUDF.get_result_buffers">
<code class="sig-name descname">get_result_buffers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#SparseCorrelationUDF.get_result_buffers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.SparseCorrelationUDF.get_result_buffers" title="Permalink to this definition">¶</a></dt>
<dd><p>This method adds the <code class="code docutils literal notranslate"><span class="pre">corr</span></code> buffer to the result of
<a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CorrelationUDF.get_result_buffers()</span></code></a>. See source code for the
exact buffer declaration.</p>
</dd></dl>

<dl class="method">
<dt id="libertem.udf.blobfinder.correlation.SparseCorrelationUDF.postprocess">
<code class="sig-name descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#SparseCorrelationUDF.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.SparseCorrelationUDF.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>The correlation results are evaluated during postprocessing since this
implementation uses tiled processing where the correlations are
incomplete in <code class="xref py py-meth docutils literal notranslate"><span class="pre">process_tile()</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.correlation.get_correlation">
<code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">get_correlation</code><span class="sig-paren">(</span><em class="sig-param">sum_result</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#get_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.get_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the correlation between <code class="code docutils literal notranslate"><span class="pre">sum_result</span></code> and <code class="code docutils literal notranslate"><span class="pre">match_pattern</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.4.0.dev0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sum_result</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – 2D result frame as correlation input</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code> to correlate
<code class="code docutils literal notranslate"><span class="pre">sum_result</span></code> with</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.correlation.get_peaks">
<code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">get_peaks</code><span class="sig-paren">(</span><em class="sig-param">sum_result</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em>, <em class="sig-param">num_peaks</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#get_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.get_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks of the correlation between <code class="code docutils literal notranslate"><span class="pre">sum_result</span></code> and <code class="code docutils literal notranslate"><span class="pre">match_pattern</span></code>.</p>
<p>The result  can then be used as input to
<a class="reference internal" href="#libertem.analysis.fullmatch.FullMatcher.full_match" title="libertem.analysis.fullmatch.FullMatcher.full_match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">full_match()</span></code></a>
to extract grid parameters, <a class="reference internal" href="#libertem.udf.blobfinder.correlation.run_fastcorrelation" title="libertem.udf.blobfinder.correlation.run_fastcorrelation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_fastcorrelation()</span></code></a>
to find the position in each frame or to construct a mask to extract feature vectors with
<a class="reference internal" href="#libertem.udf.blobfinder.utils.feature_vector" title="libertem.udf.blobfinder.utils.feature_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">feature_vector()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sum_result</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – 2D result frame as correlation input</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code> to correlate
<code class="code docutils literal notranslate"><span class="pre">sum_result</span></code> with</p></li>
<li><p><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of peaks to find</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">libertem</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">generate</span><span class="o">.</span><span class="n">cbed_frame</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">libertem</span><span class="o">.</span><span class="n">udf</span><span class="o">.</span><span class="n">blobfinder</span><span class="o">.</span><span class="n">RadialGradient</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span> <span class="o">=</span> <span class="n">get_peaks</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pattern</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<span class="go">[[64 64]</span>
<span class="go"> [64 80]</span>
<span class="go"> [80 80]</span>
<span class="go"> [80 64]</span>
<span class="go"> [48 80]</span>
<span class="go"> [48 64]</span>
<span class="go"> [64 96]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="libertem.udf.blobfinder.correlation.peak_elevation">
<code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">peak_elevation</code><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#peak_elevation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.peak_elevation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the slope of the tightest cone around <code class="code docutils literal notranslate"><span class="pre">center</span></code> with height <code class="code docutils literal notranslate"><span class="pre">height</span></code>
that touches <code class="code docutils literal notranslate"><span class="pre">corrmap</span></code> between <code class="code docutils literal notranslate"><span class="pre">r_min</span></code> and <code class="code docutils literal notranslate"><span class="pre">r_max</span></code>.</p>
<p>The correlation of two disks – mask and perfect diffraction spot – has the shape of a cone.
The function’s return value correlates with the quality of a correlation. Higher slope
means a strong peak and
no side maxima, while weak signal or side maxima lead to a flatter slope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – (y, x) coordinates of the center within the <code class="code docutils literal notranslate"><span class="pre">corrmap</span></code></p></li>
<li><p><strong>corrmap</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Correlation map</p></li>
<li><p><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The height is provided as a parameter since center can be float values from refinement
and the height value is conveniently available from the calling function.</p></li>
<li><p><strong>r_min</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Masks out a small local plateau around the peak that would distort and dominate
the calculation.</p></li>
<li><p><strong>r_max</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Mask out neighboring peaks if a large area with several legitimate peaks is
correlated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>elevation</strong> – Elevation of the tightest cone that fits the correlation map within the given
parameter range.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.correlation.run_blobfinder">
<code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">run_blobfinder</code><span class="sig-paren">(</span><em class="sig-param">ctx</em>, <em class="sig-param">dataset</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em>, <em class="sig-param">num_peaks</em>, <em class="sig-param">roi=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#run_blobfinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.run_blobfinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to find peaks in a dataset and refine their position using
<a class="reference internal" href="#libertem.udf.blobfinder.correlation.FastCorrelationUDF" title="libertem.udf.blobfinder.correlation.FastCorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastCorrelationUDF</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<a class="reference internal" href="../api.html#libertem.api.Context" title="libertem.api.Context"><em>libertem.api.Context</em></a>) – </p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../dataset.html#libertem.io.dataset.base.DataSet" title="libertem.io.dataset.base.DataSet"><em>libertem.io.dataset.base.DataSet</em></a>) – </p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>libertem.udf.blobfinder.patterns.MatchPattern</em></a>) – </p></li>
<li><p><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of peaks to look for</p></li>
<li><p><strong>roi</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Boolean mask of the navigation dimension to select region of interest (ROI)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sum_result</strong> (<em>numpy.ndarray</em>) – Log-scaled sum frame of the dataset/ROI</p></li>
<li><p><strong>centers, refineds, peak_values, peak_elevations</strong> (<em>libertem.common.buffers.BufferWrapper</em>) – See <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CorrelationUDF.get_result_buffers()</span></code></a> for details.</p></li>
<li><p><strong>peaks</strong> (<em>numpy.ndarray</em>) – List of found peaks with (y, x) coordinates</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.correlation.run_fastcorrelation">
<code class="sig-prename descclassname">libertem.udf.blobfinder.correlation.</code><code class="sig-name descname">run_fastcorrelation</code><span class="sig-paren">(</span><em class="sig-param">ctx</em>, <em class="sig-param">dataset</em>, <em class="sig-param">peaks</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em>, <em class="sig-param">roi=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/correlation.html#run_fastcorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.correlation.run_fastcorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to construct and run a <a class="reference internal" href="#libertem.udf.blobfinder.correlation.FastCorrelationUDF" title="libertem.udf.blobfinder.correlation.FastCorrelationUDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastCorrelationUDF</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<a class="reference internal" href="../api.html#libertem.api.Context" title="libertem.api.Context"><em>libertem.api.Context</em></a>) – </p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../dataset.html#libertem.io.dataset.base.DataSet" title="libertem.io.dataset.base.DataSet"><em>libertem.io.dataset.base.DataSet</em></a>) – </p></li>
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – List of peaks with (y, x) coordinates</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>libertem.udf.blobfinder.patterns.MatchPattern</em></a>) – </p></li>
<li><p><strong>roi</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Boolean mask of the navigation dimension to select region of interest (ROI)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>buffers</strong> – See <a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CorrelationUDF.get_result_buffers()</span></code></a> for details.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[<a class="reference internal" href="../udf.html#libertem.common.buffers.BufferWrapper" title="libertem.common.buffers.BufferWrapper">libertem.common.buffers.BufferWrapper</a>]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="refinement">
<h3>Refinement<a class="headerlink" href="#refinement" title="Permalink to this headline">¶</a></h3>
<p>UDFs and utility functions to refine grid parameters from peak positions.</p>
<span class="target" id="module-libertem.udf.blobfinder.refinement"></span><dl class="class">
<dt id="libertem.udf.blobfinder.refinement.AffineMixin">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.refinement.</code><code class="sig-name descname">AffineMixin</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#AffineMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.AffineMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.udf.blobfinder.refinement.RefinementMixin" title="libertem.udf.blobfinder.refinement.RefinementMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.refinement.RefinementMixin</span></code></a></p>
<p>Refinement using <code class="xref py py-meth docutils literal notranslate"><span class="pre">affinematch()</span></code></p>
<dl class="method">
<dt id="libertem.udf.blobfinder.refinement.AffineMixin.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#AffineMixin.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.AffineMixin.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matcher</strong> (<em>libertem.analysis.gridmatching.Matcher</em>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Matcher</span></code></p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – List of indices [(h1, k1), (h2, k2), …] of all peaks. The indices can be
non-integer and relative to any base vectors, including virtual ones like
(1, 0); (0, 1). See documentation of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">affinematch()</span></code> for details.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.refinement.FastmatchMixin">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.refinement.</code><code class="sig-name descname">FastmatchMixin</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#FastmatchMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.FastmatchMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.udf.blobfinder.refinement.RefinementMixin" title="libertem.udf.blobfinder.refinement.RefinementMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.refinement.RefinementMixin</span></code></a></p>
<p>Refinement using <code class="xref py py-meth docutils literal notranslate"><span class="pre">fastmatch()</span></code></p>
<dl class="method">
<dt id="libertem.udf.blobfinder.refinement.FastmatchMixin.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#FastmatchMixin.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.FastmatchMixin.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matcher</strong> (<em>libertem.analysis.gridmatching.Matcher</em>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Matcher</span></code></p></li>
<li><p><strong>start_zero</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value (y, x) in px for “zero” point (origin, zero order peak)</p></li>
<li><p><strong>start_a</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value (y, x) in px for “a” vector.</p></li>
<li><p><strong>start_b</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value (y, x) in px for “b” vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.udf.blobfinder.refinement.RefinementMixin">
<em class="property">class </em><code class="sig-prename descclassname">libertem.udf.blobfinder.refinement.</code><code class="sig-name descname">RefinementMixin</code><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#RefinementMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.RefinementMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>To be combined with a <code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.CorrelationUDF</span></code>
using multiple inheritance.</p>
<p>The mixin must come before the UDF in the inheritance list.</p>
<p>The subclasses implement a <code class="code docutils literal notranslate"><span class="pre">postprocess</span></code> method that calculates a
refinement of start_zero, start_a and start_b based on the correlation
result and populates the appropriate result buffers with this refinement
result.</p>
<p>This allows combining arbitrary implementations of correlation-based
matching with arbitrary implementations of the refinement by declaring an
ad-hoc class that inherits from one subclass of RefinementMixin and one
subclass of CorrelationUDF.</p>
<dl class="method">
<dt id="libertem.udf.blobfinder.refinement.RefinementMixin.apply_match">
<code class="sig-name descname">apply_match</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">match</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#RefinementMixin.apply_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.RefinementMixin.apply_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this method to change how a match is saved in the result
buffers, for example to support binned processing or ragged result
arrays.</p>
</dd></dl>

<dl class="method">
<dt id="libertem.udf.blobfinder.refinement.RefinementMixin.get_result_buffers">
<code class="sig-name descname">get_result_buffers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#RefinementMixin.get_result_buffers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.RefinementMixin.get_result_buffers" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds <code class="code docutils literal notranslate"><span class="pre">zero</span></code>, <code class="code docutils literal notranslate"><span class="pre">a</span></code>, <code class="code docutils literal notranslate"><span class="pre">b</span></code>, <code class="code docutils literal notranslate"><span class="pre">selector</span></code>,
<code class="code docutils literal notranslate"><span class="pre">error</span></code> to the superclass result buffer declaration.</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">zero</span></code>, <code class="code docutils literal notranslate"><span class="pre">a</span></code>, <code class="code docutils literal notranslate"><span class="pre">b</span></code>:</dt><dd><p>Grid refinement parameters for each frame.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">selector</span></code>:</dt><dd><p>Boolean mask of the peaks that were used in the fit.</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">error</span></code>:</dt><dd><p>Residual of the fit.</p>
</dd>
</dl>
<p>See source code for the exact buffer declaration.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.refinement.run_refine">
<code class="sig-prename descclassname">libertem.udf.blobfinder.refinement.</code><code class="sig-name descname">run_refine</code><span class="sig-paren">(</span><em class="sig-param">ctx</em>, <em class="sig-param">dataset</em>, <em class="sig-param">zero</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em>, <em class="sig-param">matcher: libertem.analysis.gridmatching.Matcher</em>, <em class="sig-param">correlation='fast'</em>, <em class="sig-param">match='fast'</em>, <em class="sig-param">indices=None</em>, <em class="sig-param">steps=5</em>, <em class="sig-param">roi=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/refinement.html#run_refine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.refinement.run_refine" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to refine the given lattice for each frame by calculating
approximate peak positions and refining them for each frame using a
combination of <code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.CorrelationUDF</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.RefinementMixin</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.3.0: </span>Support for <code class="xref py py-class docutils literal notranslate"><span class="pre">FullFrameCorrelationUDF</span></code>
through parameter <code class="code docutils literal notranslate"><span class="pre">correlation</span> <span class="pre">=</span> <span class="pre">'fullframe'</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<a class="reference internal" href="../api.html#libertem.api.Context" title="libertem.api.Context"><em>libertem.api.Context</em></a>) – Instance of a LiberTEM <a class="reference internal" href="../api.html#libertem.api.Context" title="libertem.api.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code></a></p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="../dataset.html#libertem.io.dataset.base.DataSet" title="libertem.io.dataset.base.DataSet"><em>libertem.io.dataset.base.DataSet</em></a>) – Instance of a <a class="reference internal" href="../dataset.html#libertem.io.dataset.base.DataSet" title="libertem.io.dataset.base.DataSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataSet</span></code></a></p></li>
<li><p><strong>zero</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value for “zero” point (y, x) in px (origin, zero order
peak)</p></li>
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value for “a” vector (y, x) in px.</p></li>
<li><p><strong>b</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Approximate value for “b” vector (y, x) in px.</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code></p></li>
<li><p><strong>matcher</strong> (<em>libertem.analysis.gridmatching.Matcher</em>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Matcher</span></code> to perform the matching</p></li>
<li><p><strong>correlation</strong> (<em>{'fast'</em><em>, </em><em>'sparse'</em><em>, </em><em>'fullframe'}</em><em>, </em><em>optional</em>) – ‘fast’, ‘sparse’ or ‘fullframe’ to select <code class="xref py py-class docutils literal notranslate"><span class="pre">FastCorrelationUDF</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">SparseCorrelationUDF</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">FullFrameCorrelationUDF</span></code></p></li>
<li><p><strong>match</strong> (<em>{'fast'</em><em>, </em><em>'affine'}</em><em>, </em><em>optional</em>) – ‘fast’ or ‘affine’ to select
<a class="reference internal" href="#libertem.udf.blobfinder.refinement.FastmatchMixin" title="libertem.udf.blobfinder.refinement.FastmatchMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastmatchMixin</span></code></a> or <a class="reference internal" href="#libertem.udf.blobfinder.refinement.AffineMixin" title="libertem.udf.blobfinder.refinement.AffineMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">AffineMixin</span></code></a></p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – Indices to refine. This is trimmed down to
positions within the frame. As a convenience, for the indices parameter
this function accepts both shape (n, 2) and (2, n, m) so that
numpy.mgrid[h:k, i:j] works directly to specify indices. This saves
boilerplate code when using this function.
Default: numpy.mgrid[-10:10, -10:10].</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Only for correlation == ‘sparse’: Correlation steps. See
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> for
details.</p></li>
<li><p><strong>roi</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – ROI for <a class="reference internal" href="../api.html#libertem.api.Context.run_udf" title="libertem.api.Context.run_udf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_udf()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result</strong> (<em>Dict[str, BufferWrapper]</em>) – Result buffers of the UDF. See
<a class="reference internal" href="#libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers" title="libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">libertem.udf.blobfinder.correlation.CorrelationUDF.get_result_buffers()</span></code></a> and
<a class="reference internal" href="#libertem.udf.blobfinder.refinement.RefinementMixin.get_result_buffers" title="libertem.udf.blobfinder.refinement.RefinementMixin.get_result_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RefinementMixin.get_result_buffers()</span></code></a> for details on the available
buffers.</p></li>
<li><p><strong>used_indices</strong> (<em>numpy.ndarray</em>) – The peak indices that were within the frame.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;memory&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">used_indices</span><span class="p">)</span> <span class="o">=</span> <span class="n">run_refine</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ctx</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">zero</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">match_pattern</span><span class="o">=</span><span class="n">libertem</span><span class="o">.</span><span class="n">udf</span><span class="o">.</span><span class="n">blobfinder</span><span class="o">.</span><span class="n">RadialGradient</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">matcher</span><span class="o">=</span><span class="n">grm</span><span class="o">.</span><span class="n">Matcher</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;centers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>  
<span class="go">array(...)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="blobfinder-utilities">
<h3>Blobfinder utilities<a class="headerlink" href="#blobfinder-utilities" title="Permalink to this headline">¶</a></h3>
<p>General utility functions for the blobfinder module.</p>
<span class="target" id="module-libertem.udf.blobfinder.utils"></span><dl class="function">
<dt id="libertem.udf.blobfinder.utils.feature_vector">
<code class="sig-prename descclassname">libertem.udf.blobfinder.utils.</code><code class="sig-name descname">feature_vector</code><span class="sig-paren">(</span><em class="sig-param">imageSizeX</em>, <em class="sig-param">imageSizeY</em>, <em class="sig-param">peaks</em>, <em class="sig-param">match_pattern: libertem.udf.blobfinder.patterns.MatchPattern</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/utils.html#feature_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.utils.feature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates a sparse mask stack to extract a feature vector.</p>
<p>A match template based on the parameters in <code class="code docutils literal notranslate"><span class="pre">parameters</span></code> is placed at
each peak position in an individual mask layer. This mask stack can then
be used in <a class="reference internal" href="../api.html#libertem.api.Context.create_mask_job" title="libertem.api.Context.create_mask_job"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_mask_job()</span></code></a> to generate a feature vector for each
frame.</p>
<p>Summing up the mask stack along the first axis generates a mask that can be used for virtual
darkfield imaging of all peaks together.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageSizeX</strong><strong>,</strong><strong>imageSizeY</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Frame size in px</p></li>
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Peak positions in px as numpy.ndarray of shape (n, 2) with integer type</p></li>
<li><p><strong>match_pattern</strong> (<a class="reference internal" href="#libertem.udf.blobfinder.patterns.MatchPattern" title="libertem.udf.blobfinder.patterns.MatchPattern"><em>MatchPattern</em></a>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">MatchPattern</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="libertem.udf.blobfinder.utils.visualize_frame">
<code class="sig-prename descclassname">libertem.udf.blobfinder.utils.</code><code class="sig-name descname">visualize_frame</code><span class="sig-paren">(</span><em class="sig-param">ctx</em>, <em class="sig-param">ds</em>, <em class="sig-param">result</em>, <em class="sig-param">indices</em>, <em class="sig-param">r</em>, <em class="sig-param">y</em>, <em class="sig-param">x</em>, <em class="sig-param">axes</em>, <em class="sig-param">colors=None</em>, <em class="sig-param">stretch=10</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/udf/blobfinder/utils.html#visualize_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.udf.blobfinder.utils.visualize_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the refinement of a specific frame in matplotlib axes</p>
</dd></dl>

</div>
</div>
<div class="section" id="matching">
<span id="matching-api"></span><h2>Matching<a class="headerlink" href="#matching" title="Permalink to this headline">¶</a></h2>
<p>These modules contain classes and helper functions that extract and manipulate lattices from correlation results.</p>
<span class="target" id="module-libertem.analysis.gridmatching"></span><dl class="class">
<dt id="libertem.analysis.gridmatching.CorrelationResult">
<em class="property">class </em><code class="sig-prename descclassname">libertem.analysis.gridmatching.</code><code class="sig-name descname">CorrelationResult</code><span class="sig-paren">(</span><em class="sig-param">centers</em>, <em class="sig-param">refineds=None</em>, <em class="sig-param">peak_values=None</em>, <em class="sig-param">peak_elevations=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#CorrelationResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.CorrelationResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Container class for the result of correlation-based refinement of peak
positions within a frame.</p>
<dl class="method">
<dt id="libertem.analysis.gridmatching.CorrelationResult.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">centers</em>, <em class="sig-param">refineds=None</em>, <em class="sig-param">peak_values=None</em>, <em class="sig-param">peak_elevations=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#CorrelationResult.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.CorrelationResult.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.analysis.gridmatching.Match">
<em class="property">class </em><code class="sig-prename descclassname">libertem.analysis.gridmatching.</code><code class="sig-name descname">Match</code><span class="sig-paren">(</span><em class="sig-param">correlation_result: libertem.analysis.gridmatching.CorrelationResult</em>, <em class="sig-param">selector</em>, <em class="sig-param">zero</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">indices</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection" title="libertem.analysis.gridmatching.PointSelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.analysis.gridmatching.PointSelection</span></code></a></p>
<p>Class that represents a lattice match to a subset of a correlation result</p>
<p>The attributes are not guaranteed to be correct or sensible for the given lattice.
The methods <a class="reference internal" href="#libertem.analysis.gridmatching.Match.weighted_optimize" title="libertem.analysis.gridmatching.Match.weighted_optimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">weighted_optimize()</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.optimize" title="libertem.analysis.gridmatching.Match.optimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optimize()</span></code></a>
calculate a derived <a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match"><code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code></a> with a best fit of <a class="reference internal" href="#libertem.analysis.gridmatching.Match.zero" title="libertem.analysis.gridmatching.Match.zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero</span></code></a>,
<a class="reference internal" href="#libertem.analysis.gridmatching.Match.a" title="libertem.analysis.gridmatching.Match.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.b" title="libertem.analysis.gridmatching.Match.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a> based on the points and the indices.</p>
<dl class="attribute">
<dt id="libertem.analysis.gridmatching.Match.zero">
<code class="sig-name descname">zero</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Declared zero point (y, x) of the lattice</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="libertem.analysis.gridmatching.Match.a">
<code class="sig-name descname">a</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.a" title="Permalink to this definition">¶</a></dt>
<dd><p>Declared “a” vector (y, x) of the lattice</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="libertem.analysis.gridmatching.Match.b">
<code class="sig-name descname">b</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Declared “b” vector (y, x) of the lattice</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="libertem.analysis.gridmatching.Match.indices">
<code class="sig-name descname">indices</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.indices" title="Permalink to this definition">¶</a></dt>
<dd><p>List of indices (i, j) that are declared to express the matched points as linear combination
of vectors <code class="code docutils literal notranslate"><span class="pre">a</span></code> and <code class="code docutils literal notranslate"><span class="pre">b</span></code> with reference to <code class="code docutils literal notranslate"><span class="pre">zero</span></code>. The indices
can be integers or floats, and they can be precise or approximate, depending on the
matching method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">correlation_result: libertem.analysis.gridmatching.CorrelationResult</em>, <em class="sig-param">selector</em>, <em class="sig-param">zero</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">indices</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.calc_coords">
<code class="sig-name descname">calc_coords</code><span class="sig-paren">(</span><em class="sig-param">indices=None</em>, <em class="sig-param">drop_zero=False</em>, <em class="sig-param">frame_shape=None</em>, <em class="sig-param">r=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match.calc_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match.calc_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand to calculate peak coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Indices to calculate coordinates for. Both an array of (y, x) pairs
and the output of np.mgrid are supported.</p></li>
<li><p><strong>drop_zero</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Drop the zero order peak. This is important for virtual darkfield imaging.</p></li>
<li><p><strong>frame_shape</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – If set, the peaks are filtered with <code class="xref py py-meth docutils literal notranslate"><span class="pre">within_frame()</span></code></p></li>
<li><p><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Radius for <code class="xref py py-meth docutils literal notranslate"><span class="pre">within_frame()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of (y, x) coordinate pairs for peaks</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – If the shape of <code class="code docutils literal notranslate"><span class="pre">indices</span></code> is not as expected.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.calculated_refineds">
<em class="property">property </em><code class="sig-name descname">calculated_refineds</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.calculated_refineds" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated peak positions based on lattice parameters and indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.error">
<em class="property">property </em><code class="sig-name descname">error</code><a class="headerlink" href="#libertem.analysis.gridmatching.Match.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted average distance between calculated and given peak position.
numpy.float(‘inf’) if match of length zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.invalid">
<em class="property">classmethod </em><code class="sig-name descname">invalid</code><span class="sig-paren">(</span><em class="sig-param">correlation_result</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match.invalid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match.invalid" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Match</dt><dd><p>A <a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match"><code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code></a> instance with empty selector and all-‘nan’ attributes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.optimize">
<code class="sig-name descname">optimize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match.optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Least square optimization of <a class="reference internal" href="#libertem.analysis.gridmatching.Match.zero" title="libertem.analysis.gridmatching.Match.zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero</span></code></a>, <a class="reference internal" href="#libertem.analysis.gridmatching.Match.a" title="libertem.analysis.gridmatching.Match.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.b" title="libertem.analysis.gridmatching.Match.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a></p>
<p>Optimization to match the given points and indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A new <a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match"><code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code></a> instance with optimized <a class="reference internal" href="#libertem.analysis.gridmatching.Match.zero" title="libertem.analysis.gridmatching.Match.zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero</span></code></a>, <a class="reference internal" href="#libertem.analysis.gridmatching.Match.a" title="libertem.analysis.gridmatching.Match.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.b" title="libertem.analysis.gridmatching.Match.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match">Match</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>np.linalg.LinAlgError</strong> – If the solver didn’t find a solution.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.Match.weighted_optimize">
<code class="sig-name descname">weighted_optimize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#Match.weighted_optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.Match.weighted_optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted least square optimization of <a class="reference internal" href="#libertem.analysis.gridmatching.Match.zero" title="libertem.analysis.gridmatching.Match.zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero</span></code></a>, <a class="reference internal" href="#libertem.analysis.gridmatching.Match.a" title="libertem.analysis.gridmatching.Match.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.b" title="libertem.analysis.gridmatching.Match.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a></p>
<p>Optimization to match the given points and indices using <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak_elevation</span></code> as weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A new <a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match"><code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code></a> instance with optimized <a class="reference internal" href="#libertem.analysis.gridmatching.Match.zero" title="libertem.analysis.gridmatching.Match.zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zero</span></code></a>, <a class="reference internal" href="#libertem.analysis.gridmatching.Match.a" title="libertem.analysis.gridmatching.Match.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a> and <a class="reference internal" href="#libertem.analysis.gridmatching.Match.b" title="libertem.analysis.gridmatching.Match.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match">Match</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>np.linalg.LinAlgError</strong> – If the solver didn’t find a solution.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libertem.analysis.gridmatching.PointSelection">
<em class="property">class </em><code class="sig-prename descclassname">libertem.analysis.gridmatching.</code><code class="sig-name descname">PointSelection</code><span class="sig-paren">(</span><em class="sig-param">correlation_result: libertem.analysis.gridmatching.CorrelationResult</em>, <em class="sig-param">selector=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#PointSelection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class that represents a subset of a correlation result.</p>
<dl class="attribute">
<dt id="libertem.analysis.gridmatching.PointSelection.selector">
<code class="sig-name descname">selector</code><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.selector" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean mask for all points in the correlation result, <code class="code docutils literal notranslate"><span class="pre">True</span></code> indicating
selected points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.PointSelection.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">correlation_result: libertem.analysis.gridmatching.CorrelationResult</em>, <em class="sig-param">selector=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#PointSelection.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.PointSelection.centers">
<em class="property">property </em><code class="sig-name descname">centers</code><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer centers (y, x) of correlation result masked with <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection.selector" title="libertem.analysis.gridmatching.PointSelection.selector"><code class="xref py py-attr docutils literal notranslate"><span class="pre">selector</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.PointSelection.peak_elevations">
<em class="property">property </em><code class="sig-name descname">peak_elevations</code><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.peak_elevations" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak elevations of correlation result masked with <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection.selector" title="libertem.analysis.gridmatching.PointSelection.selector"><code class="xref py py-attr docutils literal notranslate"><span class="pre">selector</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.PointSelection.peak_values">
<em class="property">property </em><code class="sig-name descname">peak_values</code><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.peak_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak heights of correlation result masked with <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection.selector" title="libertem.analysis.gridmatching.PointSelection.selector"><code class="xref py py-attr docutils literal notranslate"><span class="pre">selector</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.gridmatching.PointSelection.refineds">
<em class="property">property </em><code class="sig-name descname">refineds</code><a class="headerlink" href="#libertem.analysis.gridmatching.PointSelection.refineds" title="Permalink to this definition">¶</a></dt>
<dd><p>Refined float centers (y, x) of correlation result masked
with <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection.selector" title="libertem.analysis.gridmatching.PointSelection.selector"><code class="xref py py-attr docutils literal notranslate"><span class="pre">selector</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="libertem.analysis.gridmatching.get_indices">
<code class="sig-prename descclassname">libertem.analysis.gridmatching.</code><code class="sig-name descname">get_indices</code><span class="sig-paren">(</span><em class="sig-param">points</em>, <em class="sig-param">zero</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#get_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.get_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Find indices to express each point as sum of lattice vectors from zero point</p>
<p>This could solve for arbitrarily many points, i.e. frame stacks instead of frame by frame
With that the algorithm could actually match entire frame collections at once.</p>
</dd></dl>

<dl class="function">
<dt id="libertem.analysis.gridmatching.get_transformation">
<code class="sig-prename descclassname">libertem.analysis.gridmatching.</code><code class="sig-name descname">get_transformation</code><span class="sig-paren">(</span><em class="sig-param">ref</em>, <em class="sig-param">peaks</em>, <em class="sig-param">center=None</em>, <em class="sig-param">weighs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/gridmatching.html#get_transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.gridmatching.get_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspired by Giulio Guzzinati
<a class="reference external" href="https://arxiv.org/abs/1902.06979">https://arxiv.org/abs/1902.06979</a></p>
</dd></dl>

<span class="target" id="module-libertem.analysis.fullmatch"></span><dl class="class">
<dt id="libertem.analysis.fullmatch.FullMatcher">
<em class="property">class </em><code class="sig-prename descclassname">libertem.analysis.fullmatch.</code><code class="sig-name descname">FullMatcher</code><span class="sig-paren">(</span><em class="sig-param">tolerance=3</em>, <em class="sig-param">min_weight=0.1</em>, <em class="sig-param">min_match=3</em>, <em class="sig-param">min_angle=0.3141592653589793</em>, <em class="sig-param">min_points=10</em>, <em class="sig-param">min_delta=0</em>, <em class="sig-param">max_delta=inf</em>, <em class="sig-param">min_candidates=3</em>, <em class="sig-param">max_candidates=7</em>, <em class="sig-param">clusterer=None</em>, <em class="sig-param">min_cluster_size_fraction=4</em>, <em class="sig-param">min_samples_fraction=20</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#FullMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.FullMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">libertem.analysis.gridmatching.Matcher</span></code></p>
<p>Extension of <code class="xref py py-class docutils literal notranslate"><span class="pre">Matcher</span></code> will full matching</p>
<p>Include the ability to guess grid parameters from a point cloud. This is separated
from the other code since it currently only works with <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code>,
which can be problematic
to install on some platforms. For that reason it is an optional dependency.</p>
<dl class="method">
<dt id="libertem.analysis.fullmatch.FullMatcher.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">tolerance=3</em>, <em class="sig-param">min_weight=0.1</em>, <em class="sig-param">min_match=3</em>, <em class="sig-param">min_angle=0.3141592653589793</em>, <em class="sig-param">min_points=10</em>, <em class="sig-param">min_delta=0</em>, <em class="sig-param">max_delta=inf</em>, <em class="sig-param">min_candidates=3</em>, <em class="sig-param">max_candidates=7</em>, <em class="sig-param">clusterer=None</em>, <em class="sig-param">min_cluster_size_fraction=4</em>, <em class="sig-param">min_samples_fraction=20</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#FullMatcher.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.FullMatcher.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Position tolerance in px for peaks to be considered matches</p></li>
<li><p><strong>min_weight</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Minimum peak elevation of a peak to be considered for matching</p></li>
<li><p><strong>min_match</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Minimum number of matching peaks to be considered a match.</p></li>
<li><p><strong>min_angle</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Minimum angle in radians between two vectors to be considered candidates</p></li>
<li><p><strong>min_points</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Minimum points to try clustering matching. Otherwise match directly</p></li>
<li><p><strong>min_delta</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Minimum length of a potential grid vector</p></li>
<li><p><strong>max_delta</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Maximum length of a potential grid vector</p></li>
<li><p><strong>min_candidates</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Minimum number of candidates to consider clustering matching successful.
If not enough are found, the algorithm uses a brute-force search with all
pairwise vectors between points</p></li>
<li><p><strong>max_candidates</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Maximum number of candidates to return from clustering matching</p></li>
<li><p><strong>clusterer</strong> – Instance of sklearn.cluster compatible clusterer. Default is <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code>.</p></li>
<li><p><strong>min_cluster_size_fraction</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Tuning parameter for clustering matching with <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code>.
Larger values allow
smaller or fuzzier clusters. This is used to adapt the <code class="code docutils literal notranslate"><span class="pre">min_cluster_size</span></code>
parameter of <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code> dynamically to the number of points to be
matched.
Set this to <code class="code docutils literal notranslate"><span class="pre">None</span></code> to disable dynamic adjustment of <code class="code docutils literal notranslate"><span class="pre">min_cluster_size</span></code>.
If you like to set <code class="code docutils literal notranslate"><span class="pre">min_cluster_size</span></code> to a constant value, you can
set this to <code class="code docutils literal notranslate"><span class="pre">None</span></code> and additionally set the <code class="code docutils literal notranslate"><span class="pre">clusterer</span></code> parameter with
your own clusterer object to have direct control over all parameters.</p></li>
<li><p><strong>min_samples_fraction</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Tuning parameter for clustering matching with <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code>.
Larger values allow
smaller or fuzzier clusters. This is used to adapt the <code class="code docutils literal notranslate"><span class="pre">min_samples</span></code>
parameter of <code class="xref py py-class docutils literal notranslate"><span class="pre">HDBSCAN</span></code> dynamically to the number of points to be
matched.
Set this to <code class="code docutils literal notranslate"><span class="pre">None</span></code> to disable dynamic adjustment of <code class="code docutils literal notranslate"><span class="pre">min_samples</span></code>.
If you like to set <code class="code docutils literal notranslate"><span class="pre">min_samples</span></code> to a constant value, you can
set this to <code class="code docutils literal notranslate"><span class="pre">None</span></code> and additionally set the <code class="code docutils literal notranslate"><span class="pre">clusterer</span></code> parameter with
your own clusterer object to have direct control over all parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.fullmatch.FullMatcher.full_match">
<code class="sig-name descname">full_match</code><span class="sig-paren">(</span><em class="sig-param">centers</em>, <em class="sig-param">zero=None</em>, <em class="sig-param">cand=None</em>, <em class="sig-param">refineds=None</em>, <em class="sig-param">peak_values=None</em>, <em class="sig-param">peak_elevations=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#FullMatcher.full_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.FullMatcher.full_match" title="Permalink to this definition">¶</a></dt>
<dd><p>This function extracts a list of Match objects as well two PointSelection objects
for unmatched and weak points from correlation_result and zero point.
The zero point is included in each of the matches because it is shared between all grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centers</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – numpy.ndarray of shape (n, 2) with integer centers (y, x) of peaks. This would typically
be extracted with <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_peaks()</span></code></p></li>
<li><p><strong>zero</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Zero point as numpy array (y, x).</p></li>
<li><p><strong>cand</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Optional list of candidate vectors (y, x) to use in a first matching round before
guessing.</p></li>
<li><p><strong>refineds</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – numpy.ndarray of shape (n, 2) with float centers (y, x) of peaks (subpixel refinement)</p></li>
<li><p><strong>peak_values</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – numpy.ndarray of shape (n,) with float maxima of correlation map of peaks</p></li>
<li><p><strong>peak_elevations</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – numpy.ndarray of shape (n,) with float elevation of correlation map of peaks.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">peak_elevation()</span></code> for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>matches: list of <a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match"><code class="xref py py-class docutils literal notranslate"><span class="pre">Match</span></code></a> instances,</p>
<p>unmatched: instance of <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection" title="libertem.analysis.gridmatching.PointSelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSelection</span></code></a>,</p>
<p>weak: instance of <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection" title="libertem.analysis.gridmatching.PointSelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PointSelection</span></code></a></p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#libertem.analysis.gridmatching.Match" title="libertem.analysis.gridmatching.Match">libertem.analysis.gridmatching.Match</a>, ..],        <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection" title="libertem.analysis.gridmatching.PointSelection">libertem.analysis.gridmatching.PointSelection</a>,        <a class="reference internal" href="#libertem.analysis.gridmatching.PointSelection" title="libertem.analysis.gridmatching.PointSelection">libertem.analysis.gridmatching.PointSelection</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="c1"># First peak is zero if not specified otherwise</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matcher</span> <span class="o">=</span> <span class="n">FullMatcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">unmatched</span><span class="p">,</span> <span class="n">weak</span><span class="p">)</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="n">full_match</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">zero: [64. 64.]</span>
<span class="go">a: [32.  0.]</span>
<span class="go">b: [2.90077857e-15 3.20000000e+01]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="libertem.analysis.fullmatch.FullMatcher.make_polar_vectors">
<code class="sig-name descname">make_polar_vectors</code><span class="sig-paren">(</span><em class="sig-param">coords</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#FullMatcher.make_polar_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.FullMatcher.make_polar_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate all unique pairwise connecting polar vectors between points in coords.</p>
<p>The pairwise connecting vectors are converted to polar coordinates and
filtered with parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_delta</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_delta</span></code>
to avoid calculating for unwanted higher order or random smaller vectors.</p>
<p>All calculated vectors have a positive or zero x direction.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="libertem.analysis.fullmatch.NotFoundException">
<em class="property">exception </em><code class="sig-prename descclassname">libertem.analysis.fullmatch.</code><code class="sig-name descname">NotFoundException</code><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#NotFoundException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.NotFoundException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.7/library/exceptions.html#Exception" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="libertem.analysis.fullmatch.angle_check">
<code class="sig-prename descclassname">libertem.analysis.fullmatch.</code><code class="sig-name descname">angle_check</code><span class="sig-paren">(</span><em class="sig-param">p1</em>, <em class="sig-param">p2</em>, <em class="sig-param">limit</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#angle_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.angle_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if p1 and p2 have an angle difference of at least limit,
both parallel or antiparallel</p>
</dd></dl>

<dl class="function">
<dt id="libertem.analysis.fullmatch.size_filter">
<code class="sig-prename descclassname">libertem.analysis.fullmatch.</code><code class="sig-name descname">size_filter</code><span class="sig-paren">(</span><em class="sig-param">polar</em>, <em class="sig-param">min_delta</em>, <em class="sig-param">max_delta</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/libertem/analysis/fullmatch.html#size_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libertem.analysis.fullmatch.size_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Accept a list of polar vectors
Return a list of polar vectors with length between min_delta and max_delta</p>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">GUI usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats.html">Loading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../udf.html">User-defined functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging.html">Debugging</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html">LiberTEM Context API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../udf.html">UDF API reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataset.html">Data Set API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../application.html">Application-specific API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../masks.html">Mask creation and manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals.html">Internal API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dask.html">Dask API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cluster-ds.html">Cluster data set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching.html">Distributed caching layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tips.html">Tips and tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../why_python.html">Why Python?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gsoc.html">GSoC 2020 ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authorship.html">Authorship policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgments.html">Acknowledgments</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Reference</a><ul>
  <li><a href="../application.html">Application-specific API</a><ul>
      <li>Previous: <a href="amorphous.html" title="previous chapter">Amorphous materials reference</a></li>
      <li>Next: <a href="phasechange.html" title="next chapter">Phase-change materials reference</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, LiberTEM Authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/reference/app/strain.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>